
@using Entities.Models
@using Contracts
@using System.Security.Claims
@inject IAuthService authService
@inject IUserService _userService;
@inject NavigationManager _navigationManager;
@inject IReportService _reportService;

<AuthorizeView>
    <Authorized>
        <label> Why do you want to report </label>
        <input type="text" @bind="_report.Reason"/>
        <button  @onclick="@(() =>AddReport(context.User.Identity.Name))">Submit</button>
    </Authorized>
</AuthorizeView>



@code {

    private Report _report = new Report();
    [Parameter] public Post PostForReport { get; set; }


    private async Task AddReport(string userName)
    {
        _report.Reporter =await _userService.GetUserAsync(userName);
        _report.Post = PostForReport;
        
        //Console.WriteLine($"{userName} had added report on {_report.PostId} cause {_report.Reason}");
       await _reportService.AddReport(_report);
        _navigationManager.NavigateTo($"/");
    }

}